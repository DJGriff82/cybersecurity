<h1>Edit Profile</h1>

<%= form_with model: @user, url: profile_path, local: true do |f| %>
  <% if @user.errors.any? %>
    <div class="error-messages bg-red-100 text-red-700 p-3 rounded mb-4">
      <h2><%= pluralize(@user.errors.count, "error") %> prevented this profile from saving:</h2>
      <ul class="list-disc ml-5">
        <% @user.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="mb-4">
    <%= f.label :first_name %><br>
    <%= f.text_field :first_name, class: "border p-2 w-full" %>
  </div>

  <div class="mb-4">
    <%= f.label :last_name %><br>
    <%= f.text_field :last_name, class: "border p-2 w-full" %>
  </div>

  <div class="mb-4">
    <%= f.label :email %><br>
    <%= f.email_field :email, class: "border p-2 w-full" %>
  </div>

  <div class="mb-4">
    <%= f.label :password %> <span class="text-sm text-gray-500">(leave blank if unchanged)</span><br>
    <%= f.password_field :password, class: "border p-2 w-full" %>
  </div>

  <div class="mb-4">
    <%= f.label :password_confirmation %><br>
    <%= f.password_field :password_confirmation, class: "border p-2 w-full" %>
  </div>

  <hr class="my-4">

  <div class="mb-4">
    <strong>Company:</strong><br>
    <% if @user.super_user? %>
      <em>Super User (no company)</em>
    <% elsif @user.company.present? %>
      <%= @user.company.name %>
    <% else %>
      <em>No company assigned</em>
    <% end %>
  </div>

  <hr class="my-4">

  <div>
    <%= f.submit "Update Profile", class: "bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700" %>
  </div>
<% end %>

<hr class="my-4">

<div class="mt-6">
  <%= button_to "Deactivate my account", profile_path,
        method: :delete,
        data: { confirm: "Are you sure you want to deactivate your account? You will no longer be able to log in." },
        class: "bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700" %>
</div>