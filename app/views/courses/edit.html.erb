<div class="container mx-auto px-4 py-8">
  <div class="max-w-2xl mx-auto">
    <h1 class="text-2xl font-bold text-gray-900 mb-6">Edit Course</h1>

    <%= form_with(model: [:super, @course],
                  class: "bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4") do |form| %>
      <div class="mb-4">
        <%= form.label :title, "Course Title" %>
        <%= form.text_field :title, required: true, class: "w-full border rounded" %>
      </div>

      <div class="mb-4">
        <%= form.label :description %>
        <%= form.text_area :description, rows: 4, required: true, class: "w-full border rounded" %>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-4">
        <div>
          <%= form.label :duration, "Duration (minutes)" %>
          <%= form.number_field :duration, required: true, class: "w-full border rounded" %>
        </div>
        <div>
          <%= form.label :difficulty %>
          <%= form.select :difficulty,
                          Course.difficulties.keys.map { |d| [d.titleize, d] },
                          {},
                          class: "w-full border rounded" %>
        </div>
      </div>

      <div class="mb-4">
        <%= form.label :is_active, "Active Course" %>
        <%= form.check_box :is_active %>
      </div>

      <div class="flex items-center justify-between">
        <%= link_to 'Cancel', super_courses_path, class: "bg-gray-500 text-white px-4 py-2 rounded" %>
        <%= form.submit "Update Course", class: "bg-blue-600 text-white px-4 py-2 rounded" %>
      </div>
    <% end %>

    <!-- Training Modules Section -->
    <div class="mt-8 bg-white shadow-md rounded px-8 pt-6 pb-8">
      <h2 class="text-xl font-bold mb-4">Training Modules</h2>

      <% if @course.training_modules.any? %>
        <% @course.training_modules.each do |training_module| %>
          <div class="border rounded p-4 mb-4">
            <h3 class="text-lg font-medium"><%= training_module.title %></h3>
            <p class="text-sm text-gray-500">Order: <%= training_module.order %></p>

            <div class="space-x-2">
              <%= link_to 'Edit',
                          edit_super_course_training_module_path(@course, training_module),
                          class: "text-yellow-600 text-sm" %>
              <%= link_to 'Delete',
                          super_course_training_module_path(@course, training_module),
                          method: :delete,
                          data: { confirm: 'Are you sure?' },
                          class: "text-red-600 text-sm" %>
            </div>

            <!-- Pages -->
            <div class="ml-6 mt-4">
              <h4 class="font-bold text-md mb-2">Pages</h4>
              <% if training_module.module_pages.any? %>
                <% training_module.module_pages.each do |page| %>
                  <div class="flex justify-between py-2 border-b">
                    <span><%= page.order %>. <%= page.title %></span>
                    <div class="space-x-2">
                      <%= link_to 'Edit',
                                  edit_super_course_training_module_module_page_path(@course, training_module, page),
                                  class: "text-yellow-600" %>
                      <%= link_to 'Delete',
                                  super_course_training_module_module_page_path(@course, training_module, page),
                                  method: :delete,
                                  data: { confirm: 'Are you sure?' },
                                  class: "text-red-600" %>
                    </div>
                  </div>
                <% end %>
              <% else %>
                <p class="text-gray-500">No pages yet.</p>
              <% end %>

              <%= link_to 'Add Page',
                          new_super_course_training_module_module_page_path(@course, training_module),
                          class: "bg-green-600 text-white px-3 py-1 rounded mt-2 inline-block" %>
            </div>
          </div>
        <% end %>
      <% else %>
        <p class="text-gray-500">No training modules yet.</p>
      <% end %>

      <div class="mt-4">
        <%= link_to 'Add Training Module',
                    new_super_course_training_module_path(@course),
                    class: "bg-green-600 text-white px-4 py-2 rounded text-sm" %>
      </div>
    </div>
  </div>
</div>
